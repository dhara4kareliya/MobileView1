import{l as xe}from"./vendor.ad7a5cef.js";const Ae=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const a of n)if(a.type==="childList")for(const r of a.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&s(r)}).observe(document,{childList:!0,subtree:!0});function i(n){const a={};return n.integrity&&(a.integrity=n.integrity),n.referrerpolicy&&(a.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?a.credentials="include":n.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function s(n){if(n.ep)return;n.ep=!0;const a=i(n);fetch(n.href,a)}};Ae();let o;function Oe(){return o}function te(t){We(),o=xe(t),Ne()}function We(){o&&o.connected&&o.close()}function Ne(){o.on("REQ_PLAYER_INFO",f("onPlayerInfo")),o.on("REQ_TABLE_SETTINGS",f("onTableSettings")),o.on("REQ_PLAYER_STATE",f("onPlayerState")),o.on("REQ_TABLE_STATUS",f("onTableStatus")),o.on("REQ_TABLE_SIDEPOTS",f("onTableSidePots")),o.on("REQ_TABLE_TURN",f("onTableTurn")),o.on("REQ_TABLE_ROUNDRESULT",f("onTableRoundResult")),o.on("REQ_TABLE_PLAYERSHOWCARDS",f("onTablePlayerShowCards")),o.on("REQ_PLAYER_LEAVE",f("onPlayerLeave")),o.on("connect",f("onConnect")),o.on("disconnect",f("OnDisconnect"))}const _={onPlayerInfo:[],onTableSettings:[],onPlayerState:[],onTableStatus:[],onTableSidePots:[],onTableTurn:[],onTableRoundResult:[],onTablePlayerShowCards:[],onPlayerLeave:[],onConnect:[]};function Me(t,e){if(console.log(`EventName: ${t}
Data:`),console.log(e),!!_[t]){try{e=JSON.parse(e)}catch{}_[t].forEach(i=>{i(e)})}}function f(t){return e=>{Me(t,e)}}function u(t,e){if(_[t]||(_[t]=[]),typeof e!="function")throw"The callback should be a function";_[t].push(e)}function R(t,e){o.emit(t,e)}function De(t,e){o.emit("REQ_PLAYER_ENTER",{user:t,user_token:t,thread:t,table:e,table_token:e})}function He(t){o.emit("REQ_PLAYER_SITDOWN",{seat:t})}function Fe(t,e){e||(e=!1),o.emit("REQ_PLAYER_BUYIN",{amount:t,autoTopUp:e})}function Ue(t,e){console.log({action:t,bet:e}),o.emit("REQ_PLAYER_ACTION",{action:t,bet:e})}const ie="https://nrpoker.net";async function Qe(t){return new Promise((e,i)=>{const s=new XMLHttpRequest;s.onreadystatechange=function(){this.readyState==4&&(this.status==200?e(this.response):i(this.response))},s.open("GET",`${ie}/${t}`,!0),s.send()})}async function Je(t,e){return new Promise((i,s)=>{const n=new XMLHttpRequest;n.onreadystatechange=function(){this.readyState==4&&(this.status==200?i(this.response):s(this.response))},n.open("POST",`${ie}/${t}`,!0),n.send(JSON.stringify(e))})}const se=Object.freeze({None:0,Leaving:1,Joining:2,SitOut:3,Waiting:4,Playing:5});Object.freeze({Empty:0,Joining:1,SitOut:2,Waiting:3,Playing:4});Object.freeze({None:0,HoleCards:1,Flop:2,Turn:3,River:4,Showdown:5,End:6});Object.freeze({None:0,HighCard:1,Pair:2,TwoPair:3,ThreeOfAKind:4,Straight:5,Flush:6,FullHouse:7,FourOfAKind:8,StraightFlush:9});class Ye{constructor(e,i,s,n){this.name=e,this.avatar=i,this.cash=s,this.chips=n}}class je{constructor(e,i,s,n,a,r,c,d,B,J,ke,Ee){this.name=e,this.numberOfSeats=i,this.mode=s,this.level=n,this.nextSB=a,this.nextBB=r,this.duration=c,this.smallBlind=d,this.bigBlind=B,this.ante=J,this.minBuyIn=ke,this.maxBuyIn=Ee}}class ze{constructor(e,i,s,n,a,r,c,d,B,J){this.breakTime=e,this.paused=i,this.round=s,this.state=n,this.cards=a,this.seatOfDealer=r,this.seatOfSmallBlind=c,this.seatOfBigBlind=d,this.pot=B,this.turn=J}}class Ge{constructor(e,i,s,n,a,r,c,d,B){e||(e=-1),this.seat=e,this.pot=i,this.call=s,this.canRaise=n,this.minRaise=a,this.maxRaise=r,this.timeout=c,this.timeToReact=d,this.timeBank=B}get canCheck(){return this.call==0}get canCall(){return this.call>0}}class Ke{constructor(e,i){this.players=e,this.pots=i}get lastPlayers(){return this.players.filter(e=>!e.fold)}get winners(){return this.players.filter(e=>e.prize>0)}}class qe{constructor(e,i){this.seat=e,this.cards=i}}const L=new Ye,y=new je,A=new ze;let O=se.None,W=-1;function m(){return W}function Xe(){const t=A.seats[W];return t?t.money:0}function Ve(t){O=se.None,W=-1,v("onPlayerLeave",t)}function Ze(t){M(t,L),v("onPlayerInfo",L)}function et(t){O=t.state,v("onPlayerState",O)}function tt(t){M(t,y),v("onTableSettings",y)}function it(t){M(t,A),W=t.seats.findIndex(e=>e.player&&e.player.name==L.name),A.seats.map(e=>`${e.state}(${e.player?e.player.name:""})`),v("onTableStatus",A)}function st(t){v("onSidePots",t)}function nt(t){let e=new Ge;M(t,e),e.seat==null&&(e.seat=-1),e.seat>=0?(e.canRaise?(e.minRaise=e.raise[0],e.maxRaise=e.raise[1]):(e.minRaise=0,e.maxRaise=0),e.timeout=e.time[0],e.timeToReact=e.time[1],e.timeBank=e.time[2]):(e.call=0,e.canRaise=!1,e.minRaise=0,e.maxRaise=0,e.timeout=0,e.timeToReact=0,e.timeBank=0),v("onRoundTurn",e)}function N(t,e=0){isNaN(e)&&(e=0),Ue(t,e)}function at(t){let e=new Ke(t.players,t.pots);v("onRoundResult",e)}function ot(){R("REQ_PLAYER_SHOWCARDS")}function rt(t){const e=new qe(t.seat,t.cards);v("onShowCards",e)}function lt(t=!0){R("REQ_PLAYER_WAITFORBB",{value:t})}function ct(t=!0){R("REQ_PLAYER_SITOUTNEXTHAND",{value:t})}function ht(){R("REQ_PLAYER_SITOUT")}function ne(){R("REQ_PLAYER_SITIN")}function Y(t){O!="Playing"&&He(t)}u("onPlayerLeave",Ve);u("onPlayerInfo",Ze);u("onTableSettings",tt);u("onPlayerState",et);u("onTableStatus",it);u("onTableSidePots",st);u("onTableTurn",nt);u("onTableRoundResult",at);u("onTablePlayerShowCards",rt);function M(t,e){for(const i in t)e[i]=t[i]}const k={};function v(t,e){if(!!k[t]){try{e=JSON.parse(e)}catch{}k[t].forEach(i=>{i(e)})}}function p(t,e){if(k[t]||(k[t]=[]),typeof e!="function")throw"The callback should be a function";k[t].push(e)}window.sitDown=Y;const dt=$("#waitForBBDiv")[0],j=$("#waitForBBCheckbox")[0],ut=$("#sitOutNextHandDiv")[0],z=$("#sitOutNextHandCheckbox")[0],ft=$("#smallBlindSpan")[0],pt=$("#bigBlindSpan")[0],ae=$("#anteSpan")[0],oe=$("#levelSpan")[0],re=$("#nextSbBb")[0],le=$("#level-timer")[0],D=$(".break-countdown")[0],ce=$("#sitIn_btn")[0],he=$("#sitOut_btn")[0],de=$("#show-card-btn")[0];class yt{constructor(){this.playerInfo={name:"Guest",seat:0},this.levelInfo={level:0,duration:0,nextSB:0,nextBB:0,ante:0},this.tableInfo={name:"Table",mode:"cash",smallBlind:0,bigBlind:0},this.breakTime=60,this.interval=void 0,this.lvlInterval=void 0,D.style.visibility="hidden",ce.addEventListener("click",()=>{this.onSitInClick()}),he.addEventListener("click",()=>{this.onSitOutClick()}),de.addEventListener("click",()=>{this.onShowCardClick()})}getTableMode(){return this.tableInfo.mode}getPlayerSeat(){return this.playerInfo.seat}setPlayerName(e){this.playerInfo.name=e.name}setLevelInfo(e,i,s,n,a){this.levelInfo.level=e,this.levelInfo.duration=Math.floor(i),this.levelInfo.nextSB=s,this.levelInfo.nextBB=n,this.levelInfo.ante=a,ae.innerText=a,oe.innerText=e,re.innerText=`${s} / ${n}`,this.showLevelDuration()}showLevel(e){this.setActive(ae,e),this.setActive(oe,e),this.setActive(re,e),this.setActive(le,e)}showLevelDuration(){this.lvlInterval==null&&(this.lvlInterval=setInterval(()=>{let e=Math.floor(this.levelInfo.duration/3600),i=Math.floor((this.levelInfo.duration-e*60)/60),s=this.levelInfo.duration-e*3600-i*60;le.innerText=e+":"+(i<10?"0"+i:i)+":"+(s<10?"0"+s:s),--this.levelInfo.duration,this.levelInfo.duration===0&&this.clearLevelDuration()},1e3))}clearLevelDuration(){clearInterval(this.lvlInterval),this.lvlInterval=void 0}setTableName(e){this.tableInfo.name=e}setSmallBlind(e){this.tableInfo.smallBlind=e,ft.innerText=e}setBigBlind(e){this.tableInfo.bigBlind=e,pt.innerText=e}setShowDollarSign(e){}showSitIn(e){ce.style.visibility=e?"visible":"hidden"}onSitInClick(){ne()}onSitOutClick(){ht()}onShowCardClick(){ot(),this.showShowCards(!1)}showShowCards(e){de.style.visibility=e?"visible":"hidden"}showSitOut(e){he.style.visibility=e?"visible":"hidden"}showWaitForBB(e){this.setActive(dt,e)}setWaitForBB(e){j.checked=e,j.addEventListener("change",()=>{lt(j.checked)})}showSitOutNextHand(e){this.setActive(ut,e)}setSitOutNextHand(e){z.checked=e,z.addEventListener("change",()=>{ct(z.checked)})}showBreakTime(e){if(!e&&this.interval!=null){this.clearBreakTime();return}!e||this.interval!=null||(D.style.visibility="visible",this.interval=setInterval(()=>{let i=Math.floor(this.breakTime/60),s=this.breakTime-i*60;$(D).find("span")[0].textContent=(i<10?"0"+i:i)+":"+(s<10?"0"+s:s),--this.breakTime,this.breakTime===0&&this.clearBreakTime()},1e3))}clearBreakTime(){D.style.visibility="hidden",clearInterval(this.interval),this.breakTime=60,this.interval=void 0}setActive(e,i){e.style.visibility=i==!1?"hidden":"visible"}}const G=$("#back-button")[0];G.addEventListener("click",ne);function mt(t){switch(ue(G,!1),t){case"SitOut":ue(G,!0);break}}function ue(t,e){t.style.visibility=e==!1?"hidden":"visible"}p("onPlayerState",mt);const fe=$("#fourColorsCheckbox")[0];fe.addEventListener("change",()=>{be(fe.checked)});let pe=!1;const H=[],I={cardWidth:102,cardHeight:142};function bt(){ye()}function ye(){const t=["s","c","d","h"],e=["2","3","4","5","6","7","8","9","10","J","Q","K","A"],i=(a,r)=>{const c=new Image;let d=r+a;H[d.toLowerCase()]=c,pe&&(a=="c"||a=="d")&&(d+="1"),c.src=`./images/png/102x142/${d}.png`};for(const a of t)for(const r of e)i(a,r);const s=new Image;H.back=s,s.src="/images/png/102x142/back.png";const n=new Image;H.mask=n,n.src="/images/png/102x142/mask.png"}function me(t){let e=t.toLowerCase();return e=e.replace("t","10"),e=="?"&&(e="back"),H[e]}function be(t){pe=t,ye()}bt();class K{constructor(e){this.canvas=e,this.cardName="?",this.position=0}setCardName(e){this.cardName=e}setPosition(e){this.position=e}drawCard(){const e=this.canvas.getContext("2d"),i=this.position*I.cardWidth;e.drawImage(me(this.cardName),i,0,I.cardWidth,I.cardHeight)}setMask(){const e=this.canvas.getContext("2d"),i=this.position*I.cardWidth;e.drawImage(me("mask"),i,0,I.cardWidth,I.cardHeight)}}window.setFourColors=be;const q=`
<div class="timer" style="visibility: hidden;">timer</div>
<div class="avatar_img">
    <img src="./images/avtar.png">
    <div class = "cards-container">
        <canvas><canvas>
    </div>
</div>
<div class="title">Tangotag</div>
<div class="price">$5.24</div>
<div class="raise action">RAISE</div>
<img class="blind">
<div class="bottom_price"><img src="./images/cicle.png"> <span>$55</span></div>
<div class="winner"> <img src="./images/WINNER.png"></div>
`,ve='<button class="sit_down_button">Sit Down</button>',vt="./images/SB.png",wt="./images/BB.png",gt="./images/D.png",we={cardWidth:102,cardHeight:142},ge=Bt();St();function Bt(){return $(".player_wrapper").sort((e,i)=>e.classList[1]==null||i.classList[1]==null?0:+e.classList[1]-+i.classList[1])}function St(){It()}class Tt{constructor(e,i){this.wrapper=e,this.cards=[],this.seatIndex=i,this.wrapper.innerHTML=q,this.name="",this.interval=void 0,this.showInBB=!1,this.bigBlind=void 0,this.money=void 0,this.bet=void 0,this.prize=void 0}setShowInBB(e){this.showInBB=e,this.setPlayerMoney(this.money),this.setPlayerBet(this.bet)}setBigBlind(e){this.bigBlind=e}setCards(e){const i=$(this.wrapper).find(".cards-container canvas")[0];if(!!i){i.width=we.cardWidth*4,i.height=we.cardHeight;for(let s=0;s<e.length;++s)this.cards[s]=new K(i),this.cards[s].setCardName(e[s]),this.cards[s].setPosition(s),this.cards[s].drawCard()}}clearCards(){const e=$(this.wrapper).find(".cards-container canvas")[0];if(!e)return;e.getContext("2d").clearRect(0,0,e.width,e.height)}setWrapperField(e,i){const s=`.${e}`;let n=$(this.wrapper).find(s)[0];if(!!n){if(i===void 0||i===!1){n.style.visibility="hidden";return}n.style.visibility="visible",i!==!0&&(e=="bottom_price"?n=$(n).find("span")[0]:e=="avatar_img"&&(n=$(n).find("img")[0]),n.tagName.toLowerCase()=="img"?n.src=i:n.innerText=i)}}setPlayerName(e){this.setWrapperField("title",e),this.name=e}setPlayerMoney(e){this.money=e;let i=e?this.showInBB?`${Math.floor(e/this.bigBlind*100)/100}BB`:`$${e}`:!1;this.setWrapperField("price",i)}setPlayerBet(e){this.bet=e;let i=e?this.showInBB?`${Math.floor(e/this.bigBlind*100)/100}BB`:`$${e}`:!1;this.setWrapperField("bottom_price",i)}setPlayerAction(e){this.setWrapperField("action",e?e.toUpperCase():!1)}showWinner(e){this.setWrapperField("winner",e)}setDealerButton(e){e?this.setWrapperField("blind",gt):this.setWrapperField("blind",!1)}setSmallBlindButton(e){e?this.setWrapperField("blind",vt):this.setWrapperField("blind",!1)}setBigBlindButton(e){e?this.setWrapperField("blind",wt):this.setWrapperField("blind",!1)}setPlayerAvatar(e){this.setWrapperField("avatar_img",e)}setTotalCardMask(){this.cards.forEach(e=>{e.setMask()})}HighlightCards(e){if(!e){this.clearCards(),this.cards.forEach(i=>{i.drawCard()});return}this.cards.forEach(i=>{e.indexOf(i.cardName.toUpperCase())==-1&&i.setMask()})}showPlayer(e){this.wrapper.innerHTML=q,this.wrapper.style.visibility=e?"visible":"hidden"}showSitDownButton(e){e?(this.wrapper.innerHTML=ve,this.wrapper.style.visibility="visible",$(this.wrapper).find(".sit_down_button")[0].addEventListener("click",()=>{Y(this.seatIndex)})):(this.wrapper.innerHTML=q,this.wrapper.style.visibility="hidden")}setTurnTimer(e,i,s){this.interval==null&&(this.interval=setInterval(()=>{$(this.wrapper).find(".timer")[0].style.visibility="visible",i>0&&($(this.wrapper).find(".timer")[0].style.color="green",$(this.wrapper).find(".timer")[0].textContent="00:"+(i<10?"0"+i:i),--i),i===0&&(s>0?($(this.wrapper).find(".timer")[0].textContent="00:"+(s<10?"0"+s:s),$(this.wrapper).find(".timer")[0].style.color="red",--s):s==0&&this.clearIntervalTimer())},1e3),setTimeout(()=>{this.clearIntervalTimer()},e*1e3))}clearTurnTimer(){this.clearIntervalTimer()}clearIntervalTimer(){const e=$(this.wrapper).find(".timer")[0];e!=null&&(e.style.visibility="hidden",e.textContent="timer"),this.interval!=null&&(clearInterval(this.interval),this.interval=void 0)}}function It(){for(let t=0;t<ge.length;t++){const e=ge[t];e.innerHTML=ve,e.seatIndex=t,$(e).find(".sit_down_button")[0].addEventListener("click",()=>{Y(e.seatIndex)})}m()!=-1&&Pt()}function Pt(){const t=$(".sit_down_button");for(const e of t)e.style.visibility="hidden"}const Ct=$(".center_div .bottom_price")[0],Be=$(".center_div")[0],_t=$(".tournament_only")[0];Rt();function Rt(){Be.style.visibility="hidden",Ct.style.visibility="hidden"}function $t(t){Be.style.visibility="visible",_t.style.visibility=t.mode=="tournament"?"visible":"hidden"}p("onTableSettings",$t);const Lt=$("#fold-button")[0],P=$("#call-button")[0],F=$("#bet-button")[0],Se=$("#bet-button div")[0],kt=$(".bottom_buttons_Wrapper")[0];$("#back-button")[0];const C=$("#bet-input")[0],Et=$("#all-in-button")[0],xt=$("#4x-button")[0],At=$("#3x-button")[0],Ot=$("#2_5x-button")[0],Wt=$(".control-minus")[0],Nt=$(".control-plus")[0],X=$("#myDIV")[0];class Mt{constructor(){Lt.addEventListener("click",()=>this.fold()),P.addEventListener("click",()=>this.checkOrCall()),F.addEventListener("click",()=>this.raise()),C.addEventListener("change",()=>this.setBet()),Et.addEventListener("click",()=>this.allIn()),xt.addEventListener("click",()=>this.setRaise(Math.floor(this.m_POT*2/3))),At.addEventListener("click",()=>this.setRaise(Math.floor(this.m_POT*1/2))),Ot.addEventListener("click",()=>this.setRaise(Math.floor(this.m_POT*1/3))),Nt.addEventListener("click",()=>this.setRaise(this.m_Raise+this.m_Increment)),Wt.addEventListener("click",()=>this.setRaise(this.m_Raise-this.m_Increment)),this.showActionUI(!1),this.m_Call=0,this.m_Raise=0,this.m_MinRaise=0,this.m_MaxRaise=0,this.m_POT=0,this.m_Increment=0,this.m_showInBB=!1,this.m_bigBlind=void 0}setShowInBB(e){this.m_showInBB=e,this.setRaise(this.m_Raise)}setBigBlind(e){this.m_bigBlind=e}setActive(e,i){e.style.visibility=i==!1?"hidden":"visible"}setDisplay(e,i){e.style.display=i==!1?"none":"block"}setRaise(e){this.m_Raise=e,C.value=e,Se.innerHTML=e?this.m_showInBB?`${Math.floor(e/this.m_bigBlind*100)/100}BB`:`$${e}`:"Raise"}allIn(){this.setRaise(this.m_MaxRaise)}setBet(){this.setRaise(+C.value)}fold(){this.showActionUI(!1),N("fold")}call(){N("bet",this.m_Call)}check(){N("bet",0)}checkOrCall(){this.showActionUI(!1),this.m_Call==0?this.check():this.call()}raise(){this.showActionUI(!1),N("bet",this.m_Raise)}showActionUI(e){this.setActive(kt,e),this.setActive(F,e),this.setDisplay(X,e)}showCall(e,i){this.m_Call=e,e==0?P.innerHTML="CHECK":(P.innerHTML="CALL",P.append(`<span>($&nbsp;${Math.floor(e)})</span>`),i?P.innerHTML="ALLIN":P.innerHTML="CALL")}showRaise(e,i,s,n){this.setActive(X,!0),this.setActive(F,!0),Se.innerHTML="RAISE",this.m_MinRaise=e,this.m_MaxRaise=i,this.m_POT=s,this.m_Increment=n,C.min=e,C.max=i,C.value=e,this.m_Raise=e}hideRaise(){this.setActive(X,!1),this.setActive(F,!1)}}const V=$("#soundCheckbox")[0];V.addEventListener("change",()=>{Dt(V.checked)});let w=!0;V.checked=!0;function Dt(t){w=t}class Te{constructor(){this.m_audioCardDealt=new Audio("../audio/Dealing-cards.wav"),this.m_audioEndStreet=new Audio("../audio/EndOfStreets.wav"),this.m_audioFlop=new Audio("../audio/Flop.wav"),this.m_audioTurnRiver=new Audio("../audio/Turn_river.wav"),this.m_audioWinnerTakePot=new Audio("../audio/Winner_take_the_pot.wav"),this.m_audioCall=new Audio("../audio/Actions/call.wav"),this.m_audioCheck=new Audio("../audio/Actions/check.wav"),this.m_audioRaise=new Audio("../audio/Actions/Raise.wav")}playCardDealt(){w&&this.m_audioCardDealt.play()}playEndStreet(){w&&this.m_audioEndStreet.play()}playFlop(){w&&this.m_audioFlop.play()}playTurnRiver(){w&&this.m_audioTurnRiver.play()}playWinnerPot(){w&&this.m_audioWinnerTakePot.play()}playCall(){w&&this.m_audioCall.play()}playCheck(){w&&this.m_audioCheck.play()}playRaise(){w&&this.m_audioRaise.play()}}const Ht=$(".totalpost span")[0],U=new Te,Ie={cardWidth:102,cardHeight:142},b=$("#main-cards-canvas")[0];b.width=Ie.cardWidth*5;b.height=Ie.cardHeight;class Ft{constructor(){this.cards=[],this.firstSeat=0,this.players=[],this.playerWrappers=[],this.init(),this.mode=E.Joining,this.showInBB=!1,this.sidePots=void 0}init(){this.playerWrappers=this.getSortedPlayerWrappers();for(let e=0;e<9;++e){let i=new Tt(this.playerWrappers[e],e);this.players.push(i)}for(let e=0;e<5;++e){let i=new K(b);this.cards.push(i)}}setTotalPot(e){Ht.innerText=this.showInBB?`${Math.floor(e/this.bigBlind*100)/100}BB`:`$${e}`}setSidePots(e){if(e===void 0)return;this.sidePots=e;const i=$(".side-pot");for(let n=0;n<i.length;++n)i[n].remove();let s=0;if(e.length!=0){for(let n=0;n<e.length;++n){let a=this.showInBB?`${Math.floor(e[n].amount/this.bigBlind*100)/100}BB`:`$${e[n].amount}`;$(".pot").append(`<div class="side-pot"><span>sidePot-${n+1} : ${a}</span></div>`),s+=e[n].amount}this.setTotalPot(s)}}setShowInBB(e){this.showInBB=e,this.setSidePots(this.sidePots),this.players.forEach(i=>{i.setShowInBB(e)})}setBigBlind(e){this.bigBlind=e,this.players.forEach(i=>{i.setBigBlind(e)})}setMode(e){this.mode=e}getSortedPlayerWrappers(){return $(".player_wrapper").sort((i,s)=>i.classList[1]==null||s.classList[1]==null?0:+i.classList[1]-+s.classList[1])}rotatePlayerWrappers(e,i){const s=this.players.slice(),n=(i-e+this.players.length)%this.players.length;for(let a=0;a<this.players.length;a++)this.players[a]=s[(a+n)%this.players.length]}setFirstSeat(e){this.firstSeat=e}setSeats(e){console.log(`table seats: ${e}`);for(let i=0;i<e.length;++i){let s=this.players[i],n=e[i];if(n.state==="Empty")s.showSitDownButton(this.mode===E.Joining);else if(s.showPlayer(!0),s.setPlayerName(n.player.name),s.setPlayerMoney(n.money),s.setPlayerAction(n.lastAction),s.setPlayerBet(n.lastAction=="allin"?n.bet:n.lastBet),n.state=="Playing"&&!n.fold?s.setCards(n.cards):s.clearCards(),n.state=="Playing")switch(n.lastAction){case"check":U.playCheck();break;case"call":U.playCall();break;case"raise":U.playRaise();break}}}setButtons(e,i,s){console.log(`table button: ${e}, ${i}, ${s}`)}setTableCards(e){if(b.getContext("2d").clearRect(0,0,b.width,b.height),e!=null)for(let s=0;s<e.length;++s)this.cards[s]=new K(b),this.cards[s].setCardName(e[s]),this.cards[s].setPosition(s),this.cards[s].drawCard()}showRoundResult(e){const i=e.players;let s=0;e.pots.forEach(n=>{const a=n.winners;setTimeout(()=>{for(let c=0;c<this.players.length;++c){let d=this.players[c];if(a.indexOf(c)!=-1){U.playWinnerPot();var r=i.filter(B=>B.seat===c)[0];d.showWinner(!0),r.hand!=null&&(this.HighlightTableCards(r.hand.cards),d.HighlightCards(r.hand.cards))}else d.setTotalCardMask()}},2e3*s),++s,setTimeout(()=>{this.HighlightTableCards(),this.players.forEach(r=>{r.HighlightCards(),r.showWinner(!1)})},2e3*s)}),setTimeout(()=>{this.players.forEach(n=>{n.HighlightCards(),n.showWinner(!1)})},2e3*s)}HighlightTableCards(e){if(!e){b.getContext("2d").clearRect(0,0,b.width,b.height),this.cards.forEach(s=>{s.drawCard()});return}console.log(`hightlight table cards: ${e} `),this.cards.forEach(i=>{e.indexOf(i.cardName.toUpperCase())==-1&&i.setMask()})}setTurn(e){for(let i=0;i<this.players.length;++i){let s=this.players[i];i==e.seat?s.setTurnTimer(e.timeout,e.timeToReact,e.timeBank):s.clearTurnTimer()}}showCards(e,i){for(let s=0;s<this.players.length;++s){let n=this.players[s];s==e&&n.setCards(i)}}}const E=Object.freeze({None:0,Joining:1,Playing:2});Object.freeze({None:0,Leaving:1,Joining:2,SitOut:3,Waiting:4,Playing:5});const Ut=$("#buy_in_div")[0],Q=$("#buyInInput")[0],Qt=$("#buyInButton")[0],Jt=$("#buyInRange")[0];class Yt{constructor(){Qt.addEventListener("click",()=>{Fe(+Q.value)})}setTableName(e){}setBlinds(e,i){}setBuyInRange(e,i){Q.min=e,Q.max=i,Jt.textContent=`minBuyIn: ${e} / maxBuyIn: ${i}`,Q.value=e}setCash(e){}setMoney(e){}showBuyIn(e){Ut.style.visibility=e==!1?"hidden":"visible"}}let Pe=-1,Ce="None",_e;const jt=5,h=new Ft,S=new Yt,l=new yt,g=new Mt,Z=new Te,ee=$("#showBBCheckbox")[0];ee.addEventListener("change",()=>{zt(ee.checked)});ee.checked=!1;function zt(t){g.setShowInBB(t),h.setShowInBB(t)}function Gt(){h.setMode(E.None),g.showActionUI(!1)}function Kt(t){l.setPlayerName(t)}function qt(t){t.mode=="tournament"?(l.showLevel(!0),l.setLevelInfo(t.level,t.duration,t.nextSB,t.nextBB,t.ante)):l.showLevel(!1),l.setTableName(t.name),l.setSmallBlind(t.smallBlind),g.setBigBlind(t.bigBlind),h.setBigBlind(t.bigBlind)}function Xt(t){switch(t){case"Joining":h.setMode(E.Joining);break;case"Waiting":case"Playing":case"SitOut":h.setMode(E.Playing);break}g.showActionUI(!1),l.showSitIn(t=="SitOut"),y.mode=="cash"?(l.showWaitForBB(t=="Waiting"),l.setWaitForBB(!0),l.showSitOutNextHand(t=="Playing"),l.setSitOutNextHand(!1),m()>=0&&t=="Joining"?Vt():Zt()):(l.showWaitForBB(!1),l.setWaitForBB(!1),l.showSitOutNextHand(!1),l.setSitOutNextHand(!1))}function Vt(){S.showBuyIn(!0),S.setTableName(y.name),S.setBlinds(y.smallBlind,y.bigBlind),S.setBuyInRange(y.minBuyIn,y.maxBuyIn),S.setCash(L.cash),S.setMoney(L.cash)}function Zt(){S.showBuyIn(!1)}function ei(t){let e=Math.max(0,m());m()!=Pe&&(h.rotatePlayerWrappers(m(),jt),Pe=m()),y.mode=="cash"&&m()>=0?l.showSitOut(!0):l.showSitOut(!1),t.state!="Showdown"&&l.showShowCards(!1),h.setFirstSeat(e),h.setSeats(t.seats),h.setButtons(t.seatOfDealer,t.seatOfSmallBlind,t.seatOfBigBlind),h.setTableCards(t.cards),l.showBreakTime(t.breakTime),t.state!=Ce&&(t.state=="Flop"?Z.playFlop():t.state=="Turn"||t.state=="River"?Z.playTurnRiver():t.state=="Showdown"),t.round!=_e&&Z.playCardDealt(),Ce=t.state,_e=t.round}function ti(t){h.showRoundResult(t);const e=t.lastPlayers;l.showShowCards(t.players.length>1&&e.length==1&&e[0].seat!=m())}function ii(t){h.setTurn(t),t.seat!=-1&&t.seat==m()?(g.showActionUI(!0),g.showCall(t.call,t.call>=Xe()),t.canRaise?g.showRaise(t.minRaise,t.maxRaise,t.pot,y.bigBlind):g.hideRaise()):g.showActionUI(!1)}function si(t){h.setSidePots(t)}function ni(t){t.seat!=m()&&h.showCards(t.seat,t.cards)}p("onPlayerInfo",Kt);p("onTableSettings",qt);p("onPlayerState",Xt);p("onPlayerLeave",Gt);p("onTableStatus",ei);p("onRoundResult",ti);p("onRoundTurn",ii);p("onSidePots",si);p("onShowCards",ni);let x=$e(),T;Re().catch(t=>{console.error(t)});u("onConnect",ri);u("onDisconnect",Re);async function Re(){if(x){if(await Le(x),!T.status)throw T.message;te(T.server)}else oi("test_player","123")}function $e(){return ai("t")}function ai(t){const e=window.location.href.match(`${t}=([^&]+)`);if(e)return e[1]}async function oi(t,e){if(!t)throw"No user ID";if(!e)throw"No password";let i=await Je("api/users/authenticate",{username:t,password:e});return i=JSON.parse(i),x=i.token,await Le(x),te(T.server),i}async function Le(t){let e=await Qe(`api.php?api=get_ts&t=${t}`);return e=JSON.parse(e),T=e,console.log(T),e}function ri(){De(x,T.token)}window.getParamToken=$e;u("onConnect",()=>{window.socket=Oe()});
